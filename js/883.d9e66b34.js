"use strict";(self["webpackChunkweek6"]=self["webpackChunkweek6"]||[]).push([[883],{4942:function(e,o,t){t.d(o,{Z:function(){return L}});var n=t(3396),a=t(7139);const l={class:"modal fade",id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},s={class:"modal-dialog modal-dialog-centered"},i={class:"modal-content"},d=(0,n._)("div",{class:"modal-header bg-danger"},[(0,n._)("h5",{class:"modal-title fw-bolder text-light",id:"exampleModalLabel"}," 注意! ")],-1),c={class:"modal-body my-3"},u=(0,n._)("p",{class:"fs-5 border-bottom border-2"},"準備刪除下列項目",-1),p={style:{"list-style-type":"none"},class:"text-primary text-opacity-75"},r=(0,n._)("b",null,"項目標題：",-1),h=(0,n._)("b",null,"項目ID：",-1),m={class:"modal-footer d-flex"},b=(0,n._)("p",{class:"me-auto"},"確認無誤後，請按下刪除鍵",-1);function _(e,o,t,_,g,f){return(0,n.wg)(),(0,n.iD)("div",l,[(0,n._)("div",s,[(0,n._)("div",i,[d,(0,n._)("div",c,[u,(0,n._)("ul",p,[(0,n._)("li",null,[r,(0,n.Uk)((0,a.zw)(t.item.title),1)]),(0,n._)("li",null,[h,(0,n.Uk)((0,a.zw)(t.item.id),1)])])]),(0,n._)("div",m,[b,(0,n._)("button",{type:"button",class:"btn btn-secondary",onClick:o[0]||(o[0]=e=>f.hideModal())}," 返回 "),(0,n._)("button",{type:"button",class:"btn btn-danger",onClick:o[1]||(o[1]=o=>e.$emit("del-item"))}," 確定刪除 ")])])])],512)}var g=t(7972),f=t.n(g),v={data(){return{modal:""}},props:{item:{}},emits:["del-item"],methods:{openModal(){this.modal.show()},hideModal(){this.modal.hide()}},mounted(){this.modal=new(f())(this.$refs.modal)}},w=t(89);const y=(0,w.Z)(v,[["render",_]]);var L=y},3883:function(e,o,t){t.r(o),t.d(o,{default:function(){return Y}});var n=t(3396),a=t(7139),l=t(9242);const s={class:"d-flex mb-3"},i={class:"ms-auto"},d={class:"table text-center align-middle"},c=(0,n._)("thead",{class:"text-center"},[(0,n._)("tr",null,[(0,n._)("th",{width:"15%",scope:"col"},"優惠卷名稱"),(0,n._)("th",{width:"5%",scope:"col"},"折扣"),(0,n._)("th",{width:"5%",scope:"col"},"到期日"),(0,n._)("th",{width:"5%",scope:"col"},"啟用狀態"),(0,n._)("th",{width:"10%",scope:"col"},"操作")])],-1),u={class:""},p={class:"form-check form-switch d-flex justify-content-center"},r=["onUpdate:modelValue","onChange"],h={class:"btn-group",role:"group"},m=["onClick"],b=["onClick"];function _(e,o,t,_,g,f){const v=(0,n.up)("Loading"),w=(0,n.up)("CouponModal"),y=(0,n.up)("DeleteModal"),L=(0,n.up)("Pagination");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(v,{active:g.isLoading,"z-index":1060},null,8,["active"]),(0,n.Wm)(w,{ref:"couponModal",coupon:g.couponList,onUpdateCoupon:f.updateCoupon},null,8,["coupon","onUpdateCoupon"]),(0,n.Wm)(y,{ref:"deleteModal",item:g.couponList,onDelItem:f.deleteCoupon},null,8,["item","onDelItem"]),(0,n._)("div",s,[(0,n._)("div",i,[(0,n._)("button",{class:"btn btn-primary",type:"submit",onClick:o[0]||(o[0]=e=>f.openModal(!0))}," 新增優惠券 ")])]),(0,n.Wm)(L,{pages:g.pagination,onChangePage:f.getCoupon},null,8,["pages","onChangePage"]),(0,n._)("table",d,[c,(0,n._)("tbody",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(g.coupons,((o,t)=>((0,n.wg)(),(0,n.iD)("tr",{key:t},[(0,n._)("td",null,(0,a.zw)(o.title),1),(0,n._)("td",null,(0,a.zw)(o.percent)+"%",1),(0,n._)("td",null,(0,a.zw)(e.$filters.date(o.due_date)),1),(0,n._)("td",u,[(0,n._)("div",p,[(0,n.wy)((0,n._)("input",{class:"form-check-input",type:"checkbox",id:"flexSwitchCheckDefault","true-value":1,"false-value":0,"onUpdate:modelValue":e=>o.is_enabled=e,onChange:e=>f.changeEnable(!1,o)},null,40,r),[[l.e8,o.is_enabled]])])]),(0,n._)("td",null,[(0,n._)("div",h,[(0,n._)("button",{type:"button",class:"btn btn-outline-primary",onClick:e=>f.openModal(!1,o)}," 編輯 ",8,m),(0,n._)("button",{type:"button",class:"btn btn-outline-danger",onClick:e=>f.openDelModal(o)}," 刪除 ",8,b)])])])))),128))])])],64)}var g=t(3628),f=t(4942);const v={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},w={class:"modal-dialog"},y={class:"modal-content"},L=(0,n._)("div",{class:"modal-header"},[(0,n._)("h5",{class:"modal-title",id:"exampleModalLabel"},"優惠券")],-1),C={class:"modal-body"},M={class:"mb-3"},x=(0,n._)("label",{for:"coupontitle",class:"form-label"},"優惠券名稱",-1),k={class:"mb-3"},D=(0,n._)("label",{for:"couponcode",class:"form-label"},"優惠代碼",-1),$={class:"mb-3"},U=(0,n._)("label",{for:"couponpercent",class:"form-label"},"折扣",-1),N={class:"mb-3"},P=(0,n._)("label",{for:"coupondate",class:"form-label"},"日期",-1),V={class:"form-check"},Z=(0,n._)("label",{class:"form-check-label",for:"couponEnable"}," 是否啟用 ",-1),z={class:"modal-footer"},S=(0,n._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1);function E(e,o,t,a,s,i){return(0,n.wg)(),(0,n.iD)("div",v,[(0,n._)("div",w,[(0,n._)("div",y,[L,(0,n._)("div",C,[(0,n._)("div",M,[x,(0,n.wy)((0,n._)("input",{type:"text",class:"form-control",id:"coupontitle","onUpdate:modelValue":o[0]||(o[0]=e=>s.couponList.title=e)},null,512),[[l.nr,s.couponList.title]])]),(0,n._)("div",k,[D,(0,n.wy)((0,n._)("input",{type:"text",class:"form-control",id:"couponcode","onUpdate:modelValue":o[1]||(o[1]=e=>s.couponList.code=e)},null,512),[[l.nr,s.couponList.code]])]),(0,n._)("div",$,[U,(0,n.wy)((0,n._)("input",{type:"number",class:"form-control",id:"couponpercent",min:"0",max:"100","onUpdate:modelValue":o[2]||(o[2]=e=>s.couponList.percent=e)},null,512),[[l.nr,s.couponList.percent]])]),(0,n._)("div",N,[P,(0,n.wy)((0,n._)("input",{type:"date",class:"form-control",id:"coupondate","onUpdate:modelValue":o[3]||(o[3]=e=>s.due_date=e)},null,512),[[l.nr,s.due_date]])]),(0,n._)("div",V,[(0,n.wy)((0,n._)("input",{class:"form-check-input",type:"checkbox",value:"",id:"couponEnable","onUpdate:modelValue":o[4]||(o[4]=e=>s.couponList.is_enabled=e),"true-value":1,"false-value":0},null,512),[[l.e8,s.couponList.is_enabled]]),Z])]),(0,n._)("div",z,[S,(0,n._)("button",{type:"button",class:"btn btn-primary",onClick:o[5]||(o[5]=o=>e.$emit("update-coupon",s.couponList))}," 送出 ")])])])],512)}var I=t(7995),O={data(){return{pagination:{},couponList:{is_enabled:0},due_date:""}},props:{coupon:{type:Object,default(){return{}}},isNew:{type:Boolean,default:!1}},mixins:[I.Z],inject:["emitter"],watch:{coupon(){this.couponList=this.coupon,this.coupon.is_enabled!==Number&&(this.couponList.is_enabled=0);const e=new Date(1e3*this.couponList.due_date).toISOString().split("T");[this.due_date]=e},due_date(){this.couponList.due_date=Math.floor(new Date(this.due_date)/1e3)}},methods:{}},W=t(89);const j=(0,W.Z)(O,[["render",E]]);var H=j,J={data(){return{coupons:[],pagination:{},isNew:!1,couponList:{},nowPage:1,isLoading:!1}},components:{Pagination:g.Z,DeleteModal:f.Z,CouponModal:H},methods:{getCoupon(e=1){this.isLoading=!0,this.nowPage=e;const o=`https://vue3-course-api.hexschool.io/v2/api/evan-classuse/admin/coupons?page=${e}`;this.$http.get(o).then((e=>{this.coupons=e.data.coupons,this.pagination=e.data.pagination,this.isLoading=!1})).catch((e=>{console.dir(e),this.isLoading=!1}))},openModal(e,o){e?(this.couponList={due_date:(new Date).getTime()/1e3},this.isNew=!0):(this.couponList=JSON.parse(JSON.stringify(o)),this.isNew=!1);const t=this.$refs.couponModal;t.openModal()},updateCoupon(e){this.isLoading=!0,this.couponList=e;let o="https://vue3-course-api.hexschool.io/v2/api/evan-classuse/admin/coupon/",t="post";this.isNew||(o=`https://vue3-course-api.hexschool.io/v2/api/evan-classuse/admin/coupon/${this.couponList.id}`,t="put");const n=this.$refs.couponModal;this.$http[t](o,{data:this.couponList}).then((()=>{n.hideModal(),this.getCoupon(this.nowPage),this.isLoading=!1})).catch((e=>{console.dir(e),this.isLoading=!1}))},changeEnable(e,o){this.isNew=e,this.updateCoupon(o)},openDelModal(e){this.couponList={...e};const{deleteModal:o}=this.$refs;o.openModal()},deleteCoupon(){this.isLoading=!0;const{deleteModal:e}=this.$refs,o=`https://vue3-course-api.hexschool.io/v2/api/evan-classuse/admin/coupon/${this.couponList.id}`;this.$http.delete(o).then((()=>{this.getCoupon(this.nowPage),e.hideModal(),this.isLoading=!1})).catch((o=>{console.dir(o),this.getCoupon(this.nowPage),e.hideModal(),this.isLoading=!1}))}},created(){this.getCoupon()}};const T=(0,W.Z)(J,[["render",_]]);var Y=T}}]);
//# sourceMappingURL=883.d9e66b34.js.map